<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FOOBLITZ â€“ Checkout</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="style.css">

<style>
body{background:#f5f7fb}
.wrap{max-width:1100px;margin:30px auto;padding:0 16px}
.box{background:#fff;padding:20px;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.08);margin-bottom:24px}
.row{display:flex;gap:20px;flex-wrap:wrap}
.col{flex:1;min-width:260px}
input,textarea{width:100%;padding:12px;border-radius:8px;border:1px solid #ccc;margin-top:8px}
.btn{width:100%;padding:14px;font-size:16px;border-radius:10px;border:none;cursor:pointer}
.primary{background:#0b74de;color:#fff}
.cod{background:#444;color:#fff}
.whatsapp{background:#25d366;color:#fff}
.qr img{width:220px;height:220px}
.total{font-size:20px;font-weight:700;margin-top:10px}
.muted{color:#666;font-size:14px}
</style>
</head>

<body>

<div class="wrap">

<h2>Checkout</h2>

<!-- ORDER SUMMARY -->
<div class="box">
<h3>Your Order</h3>
<div id="items"></div>
<div class="total">Total: <span id="total">â‚¹0</span></div>
<p id="empty" class="muted"></p>
</div>

<!-- CUSTOMER DETAILS -->
<div class="box">
<h3>Customer Details</h3>
<input id="name" placeholder="Full Name">
<input id="phone" placeholder="Phone Number">
<textarea id="address" placeholder="Delivery Address"></textarea>
</div>

<!-- PAYMENT -->
<div class="box">
<h3>Pay using UPI / GPay</h3>
<p class="muted">Mobile â†’ opens app | Desktop â†’ scan QR</p>

<div class="row">
<div class="col">
<button id="upiBtn" class="btn primary">Pay with UPI / GPay</button>
</div>
<div class="col qr">
<img id="qr">
</div>
</div>

<button id="codBtn" class="btn cod" style="margin-top:15px">Cash on Delivery (COD)</button>
</div>

<!-- CONFIRM -->
<div class="box">
<button id="sendBtn" class="btn whatsapp">
Confirm Order & Send on WhatsApp
</button>
</div>

</div>

<script>
/* ================== CONFIG ================== */
const UPI_ID = "robyjaison@oksbi";               // ex: fooblitz@okaxis
const WHATSAPP = "918848882453";            // ex: 919876543210
const SHOP = "FOOBLITZ";

/* ================== CART ================== */
const cart = JSON.parse(localStorage.getItem("fs_cart") || "{}");
const keys = Object.keys(cart);
let total = 0;

const itemsDiv = document.getElementById("items");
const totalEl = document.getElementById("total");
const emptyEl = document.getElementById("empty");

if(keys.length === 0){
  emptyEl.textContent = "Cart is empty.";
}else{
  keys.forEach(id=>{
    const p = cart[id];
    const line = document.createElement("div");
    line.textContent = `${p.name} Ã— ${p.qty} = â‚¹${p.price*p.qty}`;
    itemsDiv.appendChild(line);
    total += p.price*p.qty;
  });
  totalEl.textContent = "â‚¹"+total;
}

/* ================== ORDER ID ================== */
const ORDER_ID = "FBZ-" + Math.floor(Math.random()*100000);

/* ================== UPI ================== */
function upiLink(){
  return `upi://pay?pa=${encodeURIComponent(UPI_ID)}&pn=${SHOP}&am=${total}&cu=INR&tn=Order%20${ORDER_ID}`;
}

document.getElementById("upiBtn").onclick = ()=>{
  if(total<=0) return;
  window.location.href = upiLink();
};

if(total>0){
  document.getElementById("qr").src =
  "https://api.qrserver.com/v1/create-qr-code/?size=300x300&data="+
  encodeURIComponent(upiLink());
}

/* ================== COD ================== */
let paymentMode = "UPI";
document.getElementById("codBtn").onclick = ()=>{
  paymentMode = "COD";
  alert("Cash on Delivery selected");
};

/* ================== WHATSAPP ORDER ================== */
document.getElementById("sendBtn").onclick = ()=>{
  const name = document.getElementById("name").value;
  const phone = document.getElementById("phone").value;
  const address = document.getElementById("address").value;

  if(!name || !phone || !address){
    alert("Please fill all details");
    return;
  }

  let msg = `ğŸ›’ *NEW ORDER* %0A`;
  msg += `ğŸ†” Order ID: ${ORDER_ID}%0A%0A`;

  keys.forEach(id=>{
    const p = cart[id];
    msg += `ğŸ‘• ${p.name} Ã— ${p.qty} = â‚¹${p.price*p.qty}%0A`;
  });

  msg += `%0AğŸ’° Total: â‚¹${total}`;
  msg += `%0AğŸ’³ Payment: ${paymentMode}`;
  msg += `%0A%0AğŸ‘¤ ${name}`;
  msg += `%0AğŸ“ ${phone}`;
  msg += `%0AğŸ  ${address}`;

  window.open(`https://wa.me/${WHATSAPP}?text=${msg}`,"_blank");
  localStorage.removeItem("fs_cart");
};
</script>

</body>
</html>
